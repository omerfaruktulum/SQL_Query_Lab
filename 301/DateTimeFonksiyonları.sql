SELECT 
GETDATE() "GETDATE",
SYSDATETIME() "SYSDATETIME",
SYSDATETIMEOFFSET() "SYSDATETIMEOFFSET",
SYSUTCDATETIME() "SYSUTCDATETIME",
CURRENT_TIMESTAMP "CURRENT_TIMESTAMP",
GETUTCDATE() "GETUTCDATE"

-- DATEPART FONKSIYONU

SELECT 
DATEPART(YEAR,'2023-01-16 21:57:39:235') YEAR_,
DATEPART(MONTH,'2023-01-16 21:57:39:235') MONTH_,
DATEPART(DAY,'2023-01-16 21:57:39:235') DAY_,
DATEPART(HOUR,'2023-01-16 21:57:39:235') HOUR_,
DATEPART(MINUTE,'2023-01-16 21:57:39:235') MINUTE_,
DATEPART(SECOND,'2023-01-16 21:57:39:235') SECOND_,
DATEPART(MILLISECOND,'2023-01-16 21:57:39:235') MILISECOND_,
DATEPART(D,'2023-01-16 21:57:39:235') D_,
DATEPART(DAYOFYEAR,'2023-01-16 21:57:39:235') DAYOFYEAR_,
DATEPART(DD,'2023-01-16 21:57:39:235') DD_,
DATEPART(DW,'2023-01-16 21:57:39:235') DW_,
DATEPART(ISO_WEEK,'2023-01-16 21:57:39:235') ISO_WEEK_,
DATEPART(WEEK,'2023-01-16 21:57:39:235') WEEK_,
DATEPART(QUARTER,'2023-01-16 21:57:39:235') QUARTER_,

-- DATENAME FONKSIYONU 
SET LANGUAGE turkish

SELECT 
DATENAME(YEAR,'2023-01-16 21:57:39:235') YEAR_,
DATENAME(MONTH,'2023-01-16 21:57:39:235') MONTH_,
DATENAME(DAY,'2023-01-16 21:57:39:235') DAY_,
DATENAME(HOUR,'2023-01-16 21:57:39:235') HOUR_,
DATENAME(MINUTE,'2023-01-16 21:57:39:235') MINUTE_,
DATENAME(SECOND,'2023-01-16 21:57:39:235') SECOND_

-- DATE / TIME FROMPARTS 

SELECT DATEFROMPARTS(2022,10,22)
SELECT DATETIMEFROMPARTS(2022,10,22,10,22,10,254)
SELECT TIMEFROMPARTS(11,56,24,5,5)

-- DAY MONTH VE YEAR FONKSIYONLARI 
SELECT 
DATEPART(YEAR,'2025-07-29 07:58:51.227'),
YEAR('2025-07-29 07:58:51.227'),
MONTH('2025-07-29 07:58:51.227'),
DAY('2025-07-29 07:58:51.227'),
DATEPART(HOUR,'2025-07-29 07:58:51.227')

-- DATEDIFF FONKSIYONU 

SELECT DATEDIFF(YEAR ,'2022-01-16 18:29:45:557',GETDATE())

-- DATEADD FONKSIYONU 

SELECT DATEADD(YEAR,1,GETDATE())

-- ISDATE FONKSÄ°YONU 

SELECT ('2020-20-02')

-- ALISTIRMA 1 
-- DOGUM GUNU BUGUN OLANLARIN LISTESINI CEKINIZ
SELECT * FROM LAB01 WHERE DATEPART(MONTH,BIRTHDATE)= DATEPART(MONTH,GETDATE()) AND
  DATEPART(DAY,BIRTHDATE)= DATEPART(DAY,GETDATE())

-- ALISTIRMA 2
-- BU VERITABANINDA DOGUM GUNU 1 HAFTA SONRA OLANLARIN LISTESINI CEKINIZ 
SELECT * FROM LAB02 WHERE DATEPART(MONTH,BIRTHDATE)= DATEPART(MONTH,DATEADD(DAY,7,GETDATE())) AND
DATEPART(DAY,BIRTHDATE)= DATEPART(DAY,DATEADD(DAY,7,GETDATE()))

-- ALISTIRMA 3
-- DOGUM YILI TELEFON NUMARASINDA GECEN MUSTERILERI TESPIT EDICEK SQL SORGUSUNU YAZINIZ
SELECT ID,NAME_,SURNAME,BIRTHDATE,DATEPART(YEAR,BIRTHDATE) YEAR_,TELNR1 FROM LAB03 WHERE TELNR1 LIKE '%'+DATENAME(YEAR,BIRTHDATE)+'%' 

-- ALISTIRMA 4 
SELECT INVOICENO FATURANO,DATE_ ISLEM_BASLAMA_ZAMANI,INVOICEDATE ISLEM_BITIS_ZAMANI ,DATEDIFF(SECOND,DATE_,INVOICEDATE) BEKLEME_ZAMANI FROM LAB04
-- ALTTAKI DE AYNI CIKTIYI VERIR
SELECT INVOICENO FATURANO,MIN(DATE_) ISLEM_BASLAMA_ZAMANI,MIN(INVOICEDATE) ISLEM_BITIS_ZAMANI ,DATEDIFF(SECOND,DATE_,INVOICEDATE) BEKLEME_ZAMANI FROM LAB04 GROUP BY INVOICENO ORDER BY 1

-- ALISTIRMA 5 

SELECT CITY SEHIR,AVG(WAITTIME) ORTALAMA_KASADA_BEKLEMEZAMANI FROM 
(
SELECT DISTINCT INVOICENO , CITY,DATE_,INVOICEDATE,DATEDIFF(SECOND,DATE_,INVOICEDATE) WAITTIME FROM LAB05
) T GROUP BY CITY 
ORDER BY 2 DESC

-- ALISTIRMA 6 

SELECT CITY,INVOICENO,DATE_,INVOICEDATE,ITEMNAME,AMOUNT,BARCODEDATE FROM LAB06

SELECT CITY SEHIR , SUM(DURATION) TOPLAM_BEKLEME_SURESI , SUM(TOTALAMOUNT) TOPLAM_URUN_ADEDI ,
ROUND(SUM(DURATION) / SUM(AMOUNT),2) BIR_URUN_ICIN_HARCANAN_OKUTMA_ZAMANI
 FROM
(SELECT CITY,MIN(BARCODEDATE) FIRST_BARCODEDATE,MAX(BARCODEDATE) LAST_BARCODEDATE ,
DATEDIFF(SECOND,MIN(BARCODEDATE),MAX(BARCODEDATE)) DURATION ,
SUM(AMOUNT) TOTALAMOUNT , COUNT(ITEMCODE) ITEMCOUNT FROM LAB06 GROUP BY CITY,INVOICENO) T 
GROUP BY CITY 
ORDER BY 4 DESC

-- ALISTIRMA 7 

SELECT * FROM LAB07

UPDATE LAB07 SET BIRTHDATE = YEAR_ + '-'+MONTH_ + '-' + DAY_ 
UPDATE LAB07 SET BIRTHDATE2= BIRTHDATE WHERE ISDATE(BIRTHDATE)=1

-- ALISTIRMA 8 
SELECT DATEPART(HOUR,CREATION_DATE) SAAT , COUNT(*) YORUMSAYISI FROM LAB08 GROUP BY DATEPART(HOUR,CREATION_DATE) ORDER BY YORUMSAYISI DESC

-- ALISTIRMA 9
SET LANGUAGE TURKISH
SELECT DATENAME(DW ,CERATION_DATE) GUNADI , COUNT(*) YORUMSAYISI FROM LAB09 GROUP BY DATEPART(DW ,CERATION_DATE) , DATENAME(DW ,CERATION_DATE) ORDER BY DATEPART(DW ,CERATION_DATE)

-- ALISTIRMA 10 

SELECT Z.ZONENAME BOLGE ,V.PLATE PLAKA,VP.DATE_ TARIH FROM VEHICLEPASS VP JOIN ZONES Z ON Z.ID=VP.ZONEID JOIN VEHICLES V ON V.ID=VP.ZONEID WHERE DATE_>= DATEADD(SECOND,-30,GETDATE())